# Отчет по учебному исследовательскому проекту - реимплеменация научной статьи "StyleGAN-NADA: CLIP-Guided Domain Adaptation of Image Generators"

## Постановка проблемы
>StyleGAN-NADA решает проблему адаптации генераторов изображений к новым доменам без необходимости аннотированных данных.
>StyleCLIP может редактировать изображение только в пределах домена генератора. StyleGAN-NADA  изменяет веса генератора и, следовательно, может выходить за пределы домена. Модель способна применять изменения, которые выходят за рамки всех подходов StyleCLIP.

## Ключевая идея
>Подход заключается в использовании двух предварительно обученных генераторов: одного замороженного и одного обучаемого.
>Сначала вектор разности между входными и целевыми подсказками находится в пространстве клипов.
>Затем метод ищет соответствующий вектор преобразования в пространстве W+ StyleGAN.
>Поскольку оптимизирован сам генератор (а не отдельные скрытые векторы), после обучения он может бесконечно производить выборку изображений в целевой области.
>Это обеспечивает гибкие преобразования в стиле нулевого кадра, не требуя маркировки наборов данных или переподготовки с нуля.

## Описание решения:
Регуляризация процесса дообучения делается с помощью ограничения количества весов, которые могут меняться во время каждой итерации.
Выбираем k-top релевантных слоев, изменения в которых были теснее всего связаны с выполяемым изменением target -> source.

**Алгоритм выбора слоев для разморозки**
1. Временно размораживаем все слои модели чтобы можно было работать с градиентами.
2. Выбираем слои, которые будем обучать. В нашем случае это convs (используется Style GAN 2 для PyTorch https://github.com/rosinality/stylegan2-pytorch).
3. Проводим итерацию по обучению с помощью CLIP-лосса. 
4. Для обучаемых слоев вычисляем градиент.
5. Выбираем top-k слоев с наибольшей нормой градиента.
6. Замораживаем в convs все слои, кроме выбранных top-k слоев
>select_layers_to_unfreeze # реализция алгоритма

**Как строить обучение**
**Описание эксперимента:**
пробовали разные гиперпараметры
разные коэффициенты при лоссе

**Описание результатов**

**Выводы**

(что получилось, что не получилось и почему)
